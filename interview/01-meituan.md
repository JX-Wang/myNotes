美团面试经历
===

## 网申

提交了简历pdf,还填了一些基本信息.

## 电话预约

3.7,小姐姐电话约了面试时间:3.9,14:00.

## 电话一面

关键词 `mmap`,`malloc`

3.9,14:11.聊了30分钟.

* 面试官  `基本信息我都了解了,直接说你掌握了哪些技能,做了什么项目`

* 我 很快说了基本技能:语言层面,数据库层面,开发环境层面等.

* 我 说了DNS-detect项目,条理不是很清晰

* 面试官 `项目意义在哪里?人家已经有了ali dns可用,为什么还需要你来发现一大批DNS?怎么使用输出结果?`

* 我 内部需要,数据倒卖等.

* 面试官 不是很满意,他认为项目的驱动力不是很好.

* 我 准备说剩下的两个小demo,他好象是打断了,没让说下去.我也觉得没必要说这个,在他眼里可能就是个垃圾....

* 面试官 `C用的多吗`

* 我 `不多,但看过很多源码.`

* 面试官 `我知道你看了linux内核,你是怎么看得?只看书还是有其他的?`

* 我 `书加源码剖析,自己给内核打注释.一般流程是:罗列出问题清单,在把问题集中化,选择一块来研究,结合书和源码.`

* 面试官 `说说mmap的用途在哪里` 

* 我 瞎说了(大批量数据共享什么的),本来就没仔细研究mmap.其实应该是(引用[这里](https://www.cnblogs.com/huxiao-tee/p/4660352.html)):
	* 加快文件访问.因为普通write/read要经历内核-页高速缓存-用户空间,mmap是内核=用户空间,是一种更高效的内核与进程的交互.
	* 提供进程间共享内存及相互通信的方式。不管是父子进程还是无亲缘关系的进程，都可以将自身用户空间映射到同一个文件或匿名映射到同一片区域。从而通过各自对映射区域的改动，达到进程间通信和进程间共享的目的。
	* 可用于实现高效的大规模数据传输。内存空间不足，是制约大数据操作的一个方面，解决方案往往是借助硬盘空间协助操作，补充内存的不足。但是进一步会造成大量的文件I/O操作，极大影响效率。这个问题可以通过mmap映射很好的解决。换句话说，但凡是需要用磁盘空间代替内存的时候，mmap都可以发挥其功效。
	* 实现了用户空间和内核空间的高效交互方式。两空间的各自修改操作可以直接反映在映射的区域内，从而被对方空间及时捕捉。

* 面试官 不是很满意.`说说malloc细节,malloc调用大概经历了什么系统调用`

* 我 说了chunk,arena,do_brk等,其实还有mmap的...

* 面试官 `malloc出来的内存什么时候归还给内核`

* 我 不记得了,是在家里看得,已经过了半个多月.只好说,进程推出的时候,内核会检查引用计数什么的

* 面试官 `要是进程free了2G的内存,又不退出,内存就不还给内核?`

* 我 感觉自己脑子抽了,之前居然没说这个,我说我不记得了,我**推测**:malloc有一层缓存机制,如果free后,空闲的内存比较多并且相对连续,应该会直接给内核;否则,应该会自己维护,给后来的malloc调用使用.真正的实现细节在[这里](https://sourceware.org/glibc/wiki/MallocInternals#Free_Algorithm),总结就是:
	* 如果内存块太小,就放到fastbins链表数组里.
	* 如果内存块(chunk)是mmap获得的,直接unmmap掉.
	* 试图合并内存块
	* 合并之后,如果内存块很大,有可能会归还给内核.注意,这一步可以被推迟,等到下次malloc时才归还.

* 面试官 `能实习到什么时候`

* 我 9或者10月之前

* 面试官 `对什么部门感兴趣`

* 我 `高并发的部门吧.`

* 面试官 `你不是研究DNS的吗`

* 我 `对DNS并没有太高的兴趣...`

* 面试官 `有什么问题吗`

* 我 问他部门并发大吗

* 面试官 大.说不是我想的那样,不是用什么linux原生api,有自己的一套框架.

* 我 还需要学什么

* 面试官 `多学习学校里面的基础.最好问题导向,虽然知道vector的细节,看过各种源码对实践有好处,但都是人家做好了的东西.要知道为什么需要这些,解决问题的痛点在哪里,为什么这样设计,细节是一辈子都学不完的.`

* 我 谢谢.

* 面试官 意犹未尽,接着说了点上面一段相关的事情.

* 我 什么时候知道结果

* 面试官 内部有一套流程,他也不知道,他只是了解一些情况,填到系统.后续可能还会有一些事情.

* 我 谢谢,没问题了.结束

总体感觉回答的一般.面试官的印象可能是:对linux内核有一定研究,但不怎么问题导向.这也是今后需要努力的方向,不能只看实现细节,只为了面试而准备.

本来以为是视频面试什么的,还准备了电脑,结果只是个电话面试.没想到面试官懂内核,真是卧虎藏龙.表现不好,我感觉mmap和malloc这么基本的都答不上,基本gg.

美团招聘官网上,投递记录里暂时没有什么变化.