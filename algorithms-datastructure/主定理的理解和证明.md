# 主定理的证明


## 主定理
首先给出主定理的内容:  
> 已知常数$a\ge1 ,b>1,f(n)$是一个函数，T(n)是定义在非负整数上的递归式：
>* $T(n)=aT(n/b)+f(n)$   
>
>那么针对$f(n)$的三种情况，有如下结论成立：
>* 若 $\exists$ $\varepsilon>0$,使得$f(n)=O(n^{log_ba-\varepsilon})$，则 $$T(n)=O(n^{log_ba})$$  
>
>* 若$f(n)=\Theta(n^{log_ba})$,则$$T
(n)=\Theta(n^{log_ba}lgn)$$
>* 若$\exists \varepsilon>0$,使得$f(n)=\Omega(n^{log_ba+\varepsilon})$，且对于某个常数$c<1$和所有足够大的$n$有$af(n/b) \le cf(n)$，则$$T(n)=\Theta(f(n))$$

为了方便证明，假设b是n的正整数次幂，即$$k=log_bn,k\in N_+$$
这个假设并不影响结论的正确性，下面我将分别证明主定理的三个结论。

## 主定理的证明
首先对递归式展开  
$T(n)=aT(n/b)+f(n)$

$T(n/b)=aT(n/b^2)+f(n/b)$

$......$

$T(n/b^k)=aT(n/b^k)+f(n/b^{k-1})$

将上式代入原递归式有:

$T(n)=n^{log_ba}\cdot T(1)+\sum_{i=0}^{k-1}a^if(n/b^i)$


### 结论一
$a^i\cdot f(\frac{n}{b^i})=a^i\cdot O((\frac{n}{b^i})^{log_ba-\varepsilon})=O(a^i\cdot \frac{n^{lob_ba-\varepsilon}}{a^i}\cdot b^{i\varepsilon})=n^{log_ba-\varepsilon}\cdot O(b^{i\varepsilon})$

那么:

$T(n)=n^{log_ba}\cdot T(1)+n^{log_ba-\varepsilon}\cdot O(\sum_{i=0}^{k-1}{b^{i\varepsilon}})$

根据等比数列求和公式：

$\sum_{i=0}^{k-1}b^{i\varepsilon}=\frac{1-({b^\varepsilon})^{k}}{1-b^{\varepsilon}}=\frac{1-n^\varepsilon}{1-b^{\varepsilon}}$

$T(n)=n^{log_ba}\cdot T(1)+n^{log_ba-\varepsilon}\cdot \frac{1-n^\varepsilon}{1-b^\varepsilon}\cdot O(1)=O(n^{log_ba})+O(n^{log_ba})=O(n^{log_ba})$

结论一得到了证明。
### 结论二
$a^i\cdot f(\frac{n}{b^i})=a^i\cdot \Theta((\frac{n}{b^i})^{log_ba})=\Theta(n^{log_ba})$

那么

$T(n)=n^{log_ba}\cdot \Theta(1)+n^{log_ba}\cdot log_bn\cdot \Theta(1)=\Theta(n^{log_ba})+\Theta(n^{log_ba}\cdot log_bn)=\Theta(n^{log_ba}\cdot lgn)$

结论二得到了证明。
### 结论三
为了方便证明，假设n是足够大的。即忽略n的大小，认为

$af(n/b)\le c\cdot f(n)$ 成立，记为式(1)

则 $a^i\cdot f(n/b^i) \le a^{i-1}\cdot f(n/b^{i-1})\cdot c$

继续迭代式(1)，有

$a^if(n/b^i)\le c^i\cdot f(n)$

$\sum_{i=0}^{k-1}a^i\cdot f(n/b^i)\le\sum_{i=0}^{k-1}(c^i\cdot f(n))=f(n)\cdot \frac{1-c^k}{1-c}\le f(n)$

又因为，$f(n)=\Theta(n^{log_ba})$，则 $n^{log_ba}\cdot T(1)\le O(f(n))$

则

$T(n)\le n^{log_ba}\cdot O(1)+f(n)\cdot O(1)\le 2\cdot O(f(n)),T(n)=O(f(n))$  
$T(n)\ge 2\cdot O(f(n)),T(n)=\Omega(f(n)))$

即是$T(n)=\Theta(f(n))$


作者：张楠(150410224)
<!--




$$f(n/b^i)=O((\frac{n}{b^i})^{log_b{a-\varepsilon}})=O(\frac{n^{log_ba-\varepsilon}}{{(a-\varepsilon)}^{i}})$$
代入式(1)有
$$T(n)=a^kT(1)+O(\sum_{i=0}^{k}(\frac{a}{a-\varepsilon})^i\cdot n^{log_b{a-\varepsilon}})=n^{log_b{a-\varepsilon}}O(1)+O(n^{log_b{a-\varepsilon}})\cdot\sum_{i=0}^{k}(\frac{a}{a-\varepsilon})^i$$
显然$\sum_{i=0}^{k}(\frac{a}{a-\varepsilon})^i$是常数，则
$$T(n)=n^{log_b{a-\varepsilon}}O(1)$$
即
$$ T(n)=\Theta(n^{log_b{a-\varepsilon}})$$

* 第二种情况 -->
