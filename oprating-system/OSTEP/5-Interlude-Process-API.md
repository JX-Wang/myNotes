Operating Systems: Three Easy Pieces
=====================================

chapter 5, Interlude: Process API

这一章主要是Unix中的三个控制进程的接口，fork,exec,wait三个系统调用，顺便实现了一下重定向。
<!-- TOC -->

- [1. fork()](#1-fork)
- [2. wait()](#2-wait)
- [3. exec()](#3-exec)
- [4. 神奇的组合效果](#4-神奇的组合效果)

<!-- /TOC -->
# 1. fork()

fork将进程复制了一份，包括：内存，寄存器等。这可能带来一个不必要的复制动作，但是现在也有了CopyOnWrite技术，没什么好纠结的。

# 2. wait()

wait被父进程用来等待其子进程结束，可以一定程度克服父子进程运行先后顺序不确定的问题。

# 3. exec()

exec完全就像是重新创建进程。它首先将当前进程的各种信息、数据全部抹去，再换上新程序的代码段、数据段，同时初始化寄存器等。

可以感觉到，这个系统调用还是比较重的。它做的事情太多了，我们确实需要一种更轻便的系统调用。

# 4. 神奇的组合效果

确实，上面三个API都不是纯粹的创建进程，都或多或少的做了点其他事情。但他们的确可以完成创建进程的任务。

特别的，fork和exec的组合允许一些额外的操作。比如shell执行一行命令并将输出重定向到文件。过程大致如下：

* shell接受命令，执行fork，进程创建完毕
* shell做一些文件描述符的调整工作，将当前进程的stdin,stdout,stderr重定向到其他文件
* shell执行exec，执行新的程序

新的程序会将输出输出到第二步设定好的文件中。